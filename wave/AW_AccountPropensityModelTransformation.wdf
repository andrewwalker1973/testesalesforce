["{\"nodes\":{\"Compute Inception Date Oldest\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"incp_dt\"},\"label\":\"Oldest Inception Date\",\"name\":\"oldestInceptionDate\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"incp_dt\"}],\"partitionBy\":[\"ownerNationalIdCalculated\"]},\"sources\":[\"Compute Relative Movement Date\"]},\"Compute Relative Movement Date\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"movent_dt\"},\"label\":\"Movement Date Calculated\",\"name\":\"movementDateCalculated\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"movent_dt\"}],\"partitionBy\":[\"ownerNationalIdProductNameKey\"]},\"sources\":[\"Compute Relative Newest Maturity Date\"]},\"Compute Age Of Products\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Investment Age Of Customer\",\"name\":\"investmentAgeOfCustomer\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Investment\\\" then date_diff(\\\"year\\\",toDate(prsn_brth_dt_sec_epoch) ,toDate(inceptionDateOldestCalculated_sec_epoch)) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Retirement Annuity Age Of Customer\",\"name\":\"retirementAnnuityAgeOfCustomer\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"RA\\\" then date_diff(\\\"year\\\",toDate(prsn_brth_dt_sec_epoch) ,toDate(inceptionDateOldestCalculated_sec_epoch)) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Education Age Of Customer\",\"name\":\"educationAgeOfCustomer\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Education\\\" then date_diff(\\\"year\\\",toDate(prsn_brth_dt_sec_epoch) ,toDate(inceptionDateOldestCalculated_sec_epoch)) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Bond Age Of Customer\",\"name\":\"bondAgeOfCustomer\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Bond\\\" then date_diff(\\\"year\\\",toDate(prsn_brth_dt_sec_epoch) ,toDate(inceptionDateOldestCalculated_sec_epoch)) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Annuity Age Of Customer\",\"name\":\"annuityAgeOfCustomer\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Annuity\\\" then date_diff(\\\"year\\\",toDate(prsn_brth_dt_sec_epoch) ,toDate(inceptionDateOldestCalculated_sec_epoch)) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since First Investment Product\",\"name\":\"yearsSinceFirstInvestmentProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Investment\\\" then date_diff(\\\"year\\\",   toDate(inceptionDateOldestCalculated_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since Last Investment Product\",\"name\":\"yearsSinceLastInvestmentProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Investment\\\" then date_diff(\\\"year\\\",   toDate(newestInceptionDate_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since First Retirement Annuity Product\",\"name\":\"yearsSinceFirstRetirementAnnuityProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"RA\\\" then date_diff(\\\"year\\\",  toDate(inceptionDateOldestCalculated_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since Last Retirement Annuity Product\",\"name\":\"yearsSinceLastRetirementAnnuityProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"RA\\\" then date_diff(\\\"year\\\",   toDate(newestInceptionDate_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since First Education Product\",\"name\":\"yearsSinceFirstEducationProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Education\\\" then date_diff(\\\"year\\\",  toDate(inceptionDateOldestCalculated_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since Last Education Product\",\"name\":\"yearsSinceLastEducationProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Education\\\" then date_diff(\\\"year\\\",   toDate(newestInceptionDate_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since First Bond Product\",\"name\":\"yearsSinceFirstBondProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Bond\\\" then date_diff(\\\"year\\\",  toDate(inceptionDateOldestCalculated_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since Last Bond Product\",\"name\":\"yearsSinceLastBondProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Bond\\\" then date_diff(\\\"year\\\",   toDate(newestInceptionDate_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since First Annuity Product\",\"name\":\"yearsSinceFirstAnnuityProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Annuity\\\" then date_diff(\\\"year\\\", toDate(inceptionDateOldestCalculated_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since Last Annuity Product\",\"name\":\"yearsSinceLastAnnuityProduct\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Annuity\\\" then date_diff(\\\"year\\\",toDate(newestInceptionDate_sec_epoch),toDate('asOfDate_sec_epoch')) else 0 end\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute Other Fields\"]},\"Compute Other Null\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'nullFilter'==\\\"N\\\" and 'movementInceptionDateDiffereence'==1\"},\"sources\":[\"Compute Relative Inception Date Newest\"]},\"Compute Derived Variables\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Age\",\"name\":\"age\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\", toDate(prsn_brth_dt_sec_epoch), toDate('asOfDate_sec_epoch') )\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Inception Date Tenure\",\"name\":\"inceptionDateTenure\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\", toDate(incp_dt_sec_epoch), toDate('asOfDate_sec_epoch') )\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Maturity Date Tenure\",\"name\":\"maturityDateTenure\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\", toDate(mty_dt_sec_epoch), toDate('asOfDate_sec_epoch') )\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Policy Number Calculated\",\"name\":\"policyNumberCalculated\",\"saqlExpression\":\"case when 'cont_no' is null then \\\"NA\\\" else 'cont_no' end\",\"type\":\"Text\"},{\"label\":\"Product Name\",\"name\":\"productNameCalculated\",\"saqlExpression\":\"case when 'prod_name' is null then \\\"NA\\\" else 'prod_name' end\",\"type\":\"Text\"},{\"label\":\"Customer ID\",\"name\":\"ownerNationalIdCalculated\",\"saqlExpression\":\"case when 'owner_natl_id' is null then \\\"NA\\\" else 'owner_natl_id' end\",\"type\":\"Text\"},{\"label\":\"Policy Term\",\"name\":\"policyTerm\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\", toDate(mty_dt_sec_epoch), toDate(incp_dt_sec_epoch) )\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Product Group \",\"name\":\"acrProductGroupCalculated\",\"saqlExpression\":\"case when 'prod_name' == \\\"EDUCATION PLAN\\\" then \\\"Education\\\" when 'prod_name' in [\\\"LIBERTY EVOLVE PENSION FUND PRESERVER\\\",\\\"AGILE PENSION FUND PRESERVER\\\",\\\"AGILE PROVIDENT FUND PRESERVER\\\",\\\"LIBERTY EVOLVE PROVIDENT FUND PRESERVER\\\"] then \\\"Pfund\\\" when  'prod_name' in [\\\"ANNUITY\\\",\\\"FLEXIBLE ANNUITY\\\"] then \\\"Annuity\\\" when 'prod_name' in [\\\"GUARANTEED CAPITAL BOND\\\"] then \\\"Bond\\\" when 'prod_name' in [ \\\"RETIREMENT ANNUITY BUILDER\\\" ,\\\"LIBERTY RETIREMENT ANNUITY\\\" ,\\\"LIBERTY EVOLVE RETIREMENT ANNUITY\\\" ] then \\\"RA\\\" else 'acr_product_group'  end\",\"type\":\"Text\"},{\"label\":\"Frequency Calculated\",\"name\":\"frequencyCalculated\",\"saqlExpression\":\"case when 'frequency' is null then \\\"NA\\\" else 'frequency' end\",\"type\":\"Text\"},{\"label\":\"Inforce Indicator Calculated\",\"name\":\"inforceIndicatorCalculated\",\"saqlExpression\":\"case when 'inforce_ind' is null then \\\"NA\\\" else 'inforce_ind' end\",\"type\":\"Text\"},{\"label\":\"Standard Bank Match \",\"name\":\"standardBankMatch\",\"saqlExpression\":\"case when 'sb_match' is null then \\\"Liberty Customer\\\" else \\\"Both SB and Liberty customer\\\" end\",\"type\":\"Text\"},{\"label\":\"Movement Inception Date\",\"name\":\"movementInceptionDate\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\", toDate(incp_dt_sec_epoch),toDate(movent_dt_sec_epoch) )\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Movement Date Tenure\",\"name\":\"movementDateTenure\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\", toDate(movent_dt_sec_epoch), toDate('asOfDate_sec_epoch') )\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Inception Date Epoc\",\"name\":\"inceptionDateEpoc\",\"precision\":18,\"saqlExpression\":\"'incp_dt_sec_epoch'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Person Market Consent Calculated\",\"name\":\"personMarketConsentCalculated\",\"saqlExpression\":\"case when 'prsn_mrkt_cnsnt' is null then \\\"Yes\\\" else \\\"No\\\" end\",\"type\":\"Text\"},{\"label\":\"Product group category\",\"name\":\"product_group_category\",\"saqlExpression\":\"case when 'prod_name' == \\\"EDUCATION PLAN\\\" then \\\"Education\\\" when 'prod_name' in [\\\"LIBERTY EVOLVE PENSION FUND PRESERVER\\\",\\\"AGILE PENSION FUND PRESERVER\\\",\\\"AGILE PROVIDENT FUND PRESERVER\\\",\\\"LIBERTY EVOLVE PROVIDENT FUND PRESERVER\\\"] then \\\"Pfund\\\" when  'prod_name' in [\\\"ANNUITY\\\",\\\"FLEXIBLE ANNUITY\\\"] then \\\"Annuity\\\" when 'prod_name' in [\\\"GUARANTEED CAPITAL BOND\\\"] then \\\"Bond\\\" else 'acr_product_group'  end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Filter Date Of Birth\"]},\"Compute Null Values\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Null Filter\",\"name\":\"nullFilter\",\"saqlExpression\":\"case when 'incp_dt' is null and 'cont_no' is null then \\\"Y\\\" else \\\"N\\\" end\",\"type\":\"Text\"},{\"label\":\"Movement Inception Date Difference\",\"name\":\"movementInceptionDateDiffereence\",\"precision\":18,\"saqlExpression\":\"case when 'inforce_ind' == \\\"1\\\" then 0 when 'inforce_ind' == \\\"0\\\" and date_diff(\\\"year\\\",  toDate('incp_dt_sec_epoch'),toDate('movent_dt_sec_epoch')) <=2 then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Inforce Indicator Flag\",\"name\":\"inforceIndicatorFlag\",\"saqlExpression\":\"case when 'inforce_ind' == \\\"0\\\" then \\\"No\\\" else \\\"Yes\\\" end\",\"type\":\"Text\"},{\"format\":\"MM/dd/yyyy\",\"isYearEndFiscalYear\":true,\"label\":\"As Of Date\",\"name\":\"asOfDate\",\"saqlExpression\":\"toDate(\\\"06/15/2021\\\", \\\"MM/dd/yyyy\\\")\\n\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"Edgemart CustomerBase\"]},\"Compute Relative  Newest Inception Date\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"incp_dt\"},\"label\":\"Newest Inception Date\",\"name\":\"newestInceptionDate\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"incp_dt\"}],\"partitionBy\":[\"ownerNationalIdProductNameKey\"]},\"sources\":[\"Compute Relative Oldest Inception Date\"]},\"Filter Date Of Birth\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'dateOfBirth' >=18  and  'prsn_mrkt_cnsnt' is null\"},\"sources\":[\"Compute Customer Date Of Birth\"]},\"Compute Other Variable\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"years_exclude_policy\",\"name\":\"years_exclude_policy\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\",  toDate('movent_dt_sec_epoch'), toDate('asOfDate_sec_epoch'))\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Count Exclude Policy\",\"name\":\"countExcludePolicy\",\"precision\":18,\"saqlExpression\":\"1\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute Other Null\"]},\"Compute Relative Newest Maturity Date\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"mty_dt\"},\"label\":\"Newest Maturity Date Calculated\",\"name\":\"newestMaturityDateCalculated\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"mty_dt\"}],\"partitionBy\":[\"ownerNationalIdProductNameKey\"]},\"sources\":[\"Compute Relative  Newest Inception Date\"]},\"Compute Other Fields\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Inception Date String\",\"name\":\"inceptionDateString\",\"saqlExpression\":\"date_to_string(toDate('incp_dt_sec_epoch') , \\\"yyyy-MM-dd\\\")\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"Total Investment Premium\",\"name\":\"totalInvestmentPremium\",\"precision\":18,\"saqlExpression\":\"'investmentInvestmentPlan' + 'investmentFlexibleInvestmentPlan'+ 'investmentInvestmentBuilder' + 'investmentLibertyEvolveInvestmentPlan' +  'investmentGatewayInvestmentPlan'\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Total Retirement Annuity premium\",\"name\":\"totalRetirementAnnuityPremium\",\"precision\":18,\"saqlExpression\":\"'retirementAnnuityRetirementAnnuityBuilder' +'retirementAnnuityLibertyRetirementAnnuity'+ 'retirementAnnuityLibertyEvolveRetirementAnnuity' \",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Total Annuity Premium\",\"name\":\"totalAnnuityPremium\",\"precision\":18,\"saqlExpression\":\"'annuityAnnuity' +'annuityFlexibleAnnuity'\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Active Policy\",\"name\":\"activePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"1\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Investment Active Policy\",\"name\":\"investmentActivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"1\\\" and 'prod_name' in [\\\"INVESTMENT BUILDER\\\",\\\"LIBERTY EVOLVE INVESTMENT PLAN\\\",\\\"GATEWAY INVESTMENT PLAN\\\",\\\"FLEXIBLE INVESTMENT PLAN\\\",\\\"INVESTMENT PLAN\\\"] and 'acrProductGroupCalculated' == \\\"Investment\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Investment Inactive Policy\",\"name\":\"investmentInactivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"0\\\" and 'prod_name' in [\\\"INVESTMENT BUILDER\\\",\\\"LIBERTY EVOLVE INVESTMENT PLAN\\\",\\\"GATEWAY INVESTMENT PLAN\\\",\\\"FLEXIBLE INVESTMENT PLAN\\\",\\\"INVESTMENT PLAN\\\"] and 'acrProductGroupCalculated' == \\\"Investment\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Retirement Annuity Active Policy\",\"name\":\"retirementAnnuityActivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"1\\\" and 'acrProductGroupCalculated' == \\\"RA\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Retirement Annuity Inactive Policy\",\"name\":\"retirementAnnuityInactivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"0\\\" and 'acrProductGroupCalculated' == \\\"RA\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Education Active Policy\",\"name\":\"educationActivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"1\\\" and 'acrProductGroupCalculated' == \\\"Education\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Education Inactive Policy\",\"name\":\"educationInactivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"0\\\" and 'acrProductGroupCalculated' == \\\"Education\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Bond Active Policy\",\"name\":\"bondActivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"1\\\" and 'acrProductGroupCalculated' == \\\"Bond\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Bond Inactive Policy\",\"name\":\"bondInactivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"0\\\" and 'acrProductGroupCalculated' == \\\"Bond\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Annuity Active Policy\",\"name\":\"annuityActivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"1\\\" and 'acrProductGroupCalculated' == \\\"Annuity\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Annuity Inactive Policy\",\"name\":\"annuityInactivePolicy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"0\\\" and 'acrProductGroupCalculated' == \\\"Annuity\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"inactive Policy\",\"name\":\"Inactive_Policy\",\"precision\":1,\"saqlExpression\":\"case when 'inforceIndicatorCalculated' == \\\"0\\\" then 1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Years Since Oldest Policy Start\",\"name\":\"yearsSinceOldestPolicyStart\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\", toDate(oldestInceptionDate_sec_epoch), toDate('asOfDate_sec_epoch') )\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Years Since Newest Policy Start\",\"name\":\"yearsSinceNewestPolicyStart\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\",  toDate(inceptionDateNewest_sec_epoch),toDate('asOfDate_sec_epoch') )\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Filter Null Data\"]},\"Compute Customer Date Of Birth\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Date Of Birth\",\"name\":\"dateOfBirth\",\"precision\":18,\"saqlExpression\":\"date_diff(\\\"year\\\",toDate(prsn_brth_dt_sec_epoch) ,toDate(asOfDate_sec_epoch))\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute Null Values\"]},\"Compute Premium Fields\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Age Bucket\",\"name\":\"ageBucket\",\"saqlExpression\":\"case when 'age' == 0 then \\\"Age is zero\\\"\\nwhen 'age' > 0 and 'age' < 18 then \\\"Between 1 than 18\\\"\\nwhen 'age' >=18 and 'age' < 30  then \\\"Between 18 to 30\\\"\\nwhen 'age' >=30 and 'age' < 45  then \\\"Between 30 to 45\\\"\\nwhen 'age' >=45 and 'age' < 60  then \\\"Between 45 to 60\\\"\\nwhen 'age' >=60 and 'age' < 75  then \\\"Between 60 to 75\\\"\\nwhen 'age' >=75   then \\\"greater than 75\\\"\\nelse  \\\"9999\\\"\\nend \",\"type\":\"Text\"},{\"label\":\"Retirement Annuity Liberty Retirement Annuity\",\"name\":\"retirementAnnuityLibertyRetirementAnnuity\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"LIBERTY RETIREMENT ANNUITY\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Retirement Annuity Liberty Evolve Retirement Annuity\",\"name\":\"retirementAnnuityLibertyEvolveRetirementAnnuity\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"LIBERTY EVOLVE RETIREMENT ANNUITY\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Retirement Annuity Retirement Annuity Builder\",\"name\":\"retirementAnnuityRetirementAnnuityBuilder\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"RETIREMENT ANNUITY BUILDER\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Education Education Plan\",\"name\":\"educationEducationPlan\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"EDUCATION PLAN\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Bond Guaranteed Capital Bond\",\"name\":\"bondGuaranteedCapitalBond\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"GUARANTEED CAPITAL BOND\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Annuity Annuity\",\"name\":\"annuityAnnuity\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"ANNUITY\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Annuity Flexible Annuity\",\"name\":\"annuityFlexibleAnnuity\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"FLEXIBLE ANNUITY\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Investment Investment Builder\",\"name\":\"investmentInvestmentBuilder\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"INVESTMENT BUILDER\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Investment Gateway Investment Plan\",\"name\":\"investmentGatewayInvestmentPlan\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"GATEWAY INVESTMENT PLAN\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Investment Investment Plan\",\"name\":\"investmentInvestmentPlan\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"INVESTMENT PLAN\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Investment Liberty Evolve Investment Plan\",\"name\":\"investmentLibertyEvolveInvestmentPlan\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"LIBERTY EVOLVE INVESTMENT PLAN\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Investment Flexible Investment Plan\",\"name\":\"investmentFlexibleInvestmentPlan\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"FLEXIBLE INVESTMENT PLAN\\\" then 'api' else 0 end\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Maturity Date Tenure Bucket\",\"name\":\"maturityDateTenureBucket\",\"saqlExpression\":\"case when 'maturityDateTenure' < 3  then \\\"Less Than 3\\\"\\nwhen 'maturityDateTenure' >= 3 and 'maturityDateTenure' <= 5 then \\\"Between 3 than 5\\\"\\nwhen 'maturityDateTenure' >5  then \\\"Greater Than 5\\\"\\nelse  \\\"Other\\\"\\nend\",\"type\":\"Text\"},{\"label\":\"Inception Date Tenure Bucket\",\"name\":\"inceptionDateTenureBucket\",\"saqlExpression\":\"case  when 'inceptionDateTenure' < 1  then \\\"Less Than 1\\\"  when 'inceptionDateTenure' >= 0 and 'inceptionDateTenure' < 2  then \\\"Less Than 2\\\" when 'inceptionDateTenure' >= 0 and 'inceptionDateTenure' < 3  then \\\"Less Than 3\\\"\\nwhen 'inceptionDateTenure' >= 0 and 'inceptionDateTenure' <= 5 then \\\"Less than 5\\\"\\nwhen 'inceptionDateTenure' >5  then \\\"Greater Than 5\\\"\\nelse  \\\"Other\\\" end\",\"type\":\"Text\"},{\"label\":\"Policy Term Bucket\",\"name\":\"policyTermBucket\",\"saqlExpression\":\"case when 'policyTerm' <= 0  then \\\"0 tenure\\\"\\nwhen 'policyTerm' >= 1 and 'policyTerm' <= 5 then \\\"Between 1 than 5\\\"\\nwhen 'policyTerm' >5  then \\\"Greater Than 5\\\"\\nelse  \\\"Other\\\"\\nend \",\"type\":\"Text\"},{\"label\":\"Movement Inception Date Bucket\",\"name\":\"movementInceptionDateBucket\",\"saqlExpression\":\"case when 'movementInceptionDate' < 1  then \\\"Less than 1\\\"\\nwhen 'movementInceptionDate' >=1 and 'movementInceptionDate' < 2  then \\\"Between 1 and 2\\\"\\nwhen 'movementInceptionDate' >=2 and 'movementInceptionDate' < 3  then \\\"Between 2 and 3\\\"\\nelse  \\\"Greater than 3\\\" end\",\"type\":\"Text\"},{\"label\":\"Retirement Annuity Retirement Annuity Builder Flag\",\"name\":\"retirementAnnuityRetirementAnnuityBuilderFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"RETIREMENT ANNUITY BUILDER\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Retirement Annuity Liberty Retirement Annuity Flag\",\"name\":\"retirementAnnuityLibertyRetirementAnnuityFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"LIBERTY RETIREMENT ANNUITY\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Retirement Annuity Liberty Evolve Retirement Annuity Flag\",\"name\":\"retirementAnnuityLibertyEvolveRetirementAnnuityFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"LIBERTY EVOLVE RETIREMENT ANNUITY\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Education Education Plan Flag\",\"name\":\"educationEducationPlanFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"EDUCATION PLAN\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Bond Guaranteed Capital Bond Flag\",\"name\":\"bondGuaranteedCapitalBondFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"GUARANTEED CAPITAL BOND\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Annuity Annuity Flag\",\"name\":\"annuityAnnuityFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"ANNUITY\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Annuity Flexible Annuity Flag\",\"name\":\"annuityFlexibleAnnuityFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"FLEXIBLE ANNUITY\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Investment Investment Builder Flag\",\"name\":\"investmentInvestmentBuilderFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"INVESTMENT BUILDER\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Investment Gateway Investment Plan Flag\",\"name\":\"investmentGatewayInvestmentPlanFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"GATEWAY INVESTMENT PLAN\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Investment Investment Plan Flag\",\"name\":\"investmentInvestmentPlanFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"INVESTMENT PLAN\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Investment Liberty Evolve Investment Plan Flag\",\"name\":\"investmentLibertyEvolveInvestmentPlanFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"LIBERTY EVOLVE INVESTMENT PLAN\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Investment Flexible Investment Plan Flag\",\"name\":\"investmentFlexibleInvestmentPlanFlag\",\"precision\":18,\"saqlExpression\":\"case when 'prod_name' == \\\"FLEXIBLE INVESTMENT PLAN\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Risk Group Flag\",\"name\":\"riskGroupFlag\",\"precision\":18,\"saqlExpression\":\"case when 'acrProductGroupCalculated' == \\\"Risk\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Movement Date Tenure Bucket\",\"name\":\"movementDateTenureBucket\",\"saqlExpression\":\"case when 'movementDateTenure' <=1 then \\\"1_year\\\" when 'movementDateTenure' >0 and 'movementDateTenure' <=2 then \\\"2_year\\\" when 'movementDateTenure' >0 and 'movementDateTenure' <=3 then \\\"3_year\\\" else  \\\"Other\\\" end\",\"type\":\"Text\"},{\"label\":\"Frequency Monthly Calculated\",\"name\":\"frequencyMonthlyCalculated\",\"precision\":1,\"saqlExpression\":\"case when 'frequencyCalculated' == \\\"MONTHLY\\\" then  1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Frequency Lumpsum Calculated\",\"name\":\"frequencyLumpsumCalculated\",\"precision\":1,\"saqlExpression\":\"case when 'frequencyCalculated' == \\\"LUMPSUM\\\" then  1 else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Policy Expire Duration\",\"name\":\"policyExpireDuration\",\"precision\":5,\"saqlExpression\":\"date_diff(\\\"year\\\",  toDate('asOfDate_sec_epoch'), toDate(mty_dt_sec_epoch) )\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Owner National Id Product Name Key\",\"name\":\"ownerNationalIdProductNameKey\",\"saqlExpression\":\"'owner_natl_id'+'prod_name'\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Compute Derived Variables\"]},\"Register Transformed Dataset\":{\"action\":\"register\",\"parameters\":{\"label\":\"Account Propensity Model Transformed Data\",\"name\":\"AW_AccountPropensityModelTransformedData\"},\"sources\":[\"Compute Dependent Variable\"]},\"Edgemart CustomerBase\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"AW_PropensityModelCustomerBase\"}},\"Compute Dependent Variable\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Investment Dependent Variable\",\"name\":\"investmentDependentVariable\",\"precision\":18,\"saqlExpression\":\"case when 'inforce_ind' == \\\"1\\\" and 'prod_name' in [\\\"INVESTMENT BUILDER\\\",\\\"LIBERTY EVOLVE INVESTMENT PLAN\\\",\\\"GATEWAY INVESTMENT PLAN\\\",\\\"FLEXIBLE INVESTMENT PLAN\\\",\\\"INVESTMENT PLAN\\\"] and 'acrProductGroupCalculated' == \\\"Investment\\\" then 1 when 'inforce_ind' == \\\"0\\\" and 'prod_name' in [\\\"INVESTMENT BUILDER\\\",\\\"LIBERTY EVOLVE INVESTMENT PLAN\\\",\\\"GATEWAY INVESTMENT PLAN\\\",\\\"FLEXIBLE INVESTMENT PLAN\\\",\\\"INVESTMENT PLAN\\\"] and 'acrProductGroupCalculated' == \\\"Investment\\\" and date_diff(\\\"year\\\", toDate(movent_dt_sec_epoch),toDate('asOfDate_sec_epoch')) <=3 then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Retirement Annuity Dependent Variable\",\"name\":\"retirementAnnuityDependentVariable\",\"precision\":18,\"saqlExpression\":\"case when 'inforce_ind' == \\\"1\\\" and 'acrProductGroupCalculated' == \\\"RA\\\" then 1 when 'inforce_ind' == \\\"0\\\" and 'acrProductGroupCalculated' == \\\"RA\\\" and date_diff(\\\"year\\\", toDate(movent_dt_sec_epoch),toDate('asOfDate_sec_epoch')) <=3 then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Annuity Dependent Variable\",\"name\":\"annuityDependentVariable\",\"precision\":18,\"saqlExpression\":\"case when 'inforce_ind' == \\\"1\\\" and 'acrProductGroupCalculated' == \\\"Annuity\\\" then 1 when 'inforce_ind' == \\\"0\\\" and 'acrProductGroupCalculated' == \\\"Annuity\\\" and date_diff(\\\"year\\\", toDate(movent_dt_sec_epoch),toDate('asOfDate_sec_epoch')) <=3 then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Bond Dependent Variable\",\"name\":\"bondDependentVariable\",\"precision\":18,\"saqlExpression\":\"case when 'inforce_ind' == \\\"1\\\" and 'acrProductGroupCalculated' == \\\"Bond\\\" then 1 when 'inforce_ind' == \\\"0\\\" and 'acrProductGroupCalculated' == \\\"Bond\\\" and date_diff(\\\"year\\\", toDate(movent_dt_sec_epoch),toDate('asOfDate_sec_epoch')) <=3 then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Education Dependent Variable\",\"name\":\"educationDependentVariable\",\"precision\":18,\"saqlExpression\":\"case when 'inforce_ind' == \\\"1\\\" and 'acrProductGroupCalculated' == \\\"Education\\\" then 1 when 'inforce_ind' == \\\"0\\\" and 'acrProductGroupCalculated' == \\\"Education\\\" and date_diff(\\\"year\\\", toDate(movent_dt_sec_epoch),toDate('asOfDate_sec_epoch')) <=3 then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Other Investment Products\",\"name\":\"otherInvestmentProducts\",\"precision\":18,\"saqlExpression\":\"case when  'acrProductGroupCalculated' == \\\"Investment\\\" and prod_name in [\\\"INVESTMENT BUILDER\\\",\\\"LIBERTY EVOLVE INVESTMENT PLAN\\\",\\\"GATEWAY INVESTMENT PLAN\\\",\\\"FLEXIBLE INVESTMENT PLAN\\\",\\\"INVESTMENT PLAN\\\"] then 0 else 1 end\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute Age Of Products\"]},\"Compute Relative Inception Date Newest\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"incp_dt\"},\"label\":\"Inception Date Newest\",\"name\":\"inceptionDateNewest\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"incp_dt\"}],\"partitionBy\":[\"ownerNationalIdCalculated\"]},\"sources\":[\"Compute Inception Date Oldest\"]},\"Compute Relative Oldest Inception Date\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"incp_dt\"},\"label\":\"Inception Date Oldest Calculated\",\"name\":\"inceptionDateOldestCalculated\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"incp_dt\"}],\"partitionBy\":[\"ownerNationalIdProductNameKey\"]},\"sources\":[\"Compute Premium Fields\"]},\"Filter Null Data\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'nullFilter'==\\\"N\\\" and 'movementInceptionDateDiffereence'==0\"},\"sources\":[\"Compute Relative Inception Date Newest\"]},\"Register Filtered Dataset\":{\"action\":\"register\",\"parameters\":{\"label\":\"Account Propensity Model Transformed Filtered Data\",\"name\":\"AW_AccountPropensityModelTransformedFilteredData\"},\"sources\":[\"Compute Other Variable\"]}}}",null]