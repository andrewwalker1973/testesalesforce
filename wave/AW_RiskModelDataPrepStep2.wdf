["{\"nodes\":{\"Sorting_Step_1\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"all\",\"name\":\"all\",\"saqlExpression\":\"\\\"all\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Risk_Output_after_target_variable\"]},\"Row_ID\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"previous(Row_ID_Creation)+1\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Row_ID_Creation\",\"name\":\"Row_ID_Creation\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"all\"}],\"partitionBy\":[\"all\"]},\"sources\":[\"Sorting_Step_1\"]},\"Need_fulfillment_history\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Life Cover\\\" then previous(Life_Cover_Past)+1\\n else previous(Life_Cover_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Life_Cover_Past\",\"name\":\"Life_Cover_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Policy Holder Dread Disease\\\" then previous(Policy_Holder_dread_disease_Past)+1\\n else previous(Policy_Holder_dread_disease_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Policy_Holder_dread_disease_Past\",\"name\":\"Policy_Holder_dread_disease_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Policy Holder Disablement\\\" then previous(Policy_Holder_Disablement_Past)+1\\n else previous(Policy_Holder_Disablement_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Policy_Holder_Disablement_Past\",\"name\":\"Policy_Holder_Disablement_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Pregnancy Complications\\\" then previous(Pregnancy_Complications_Past)+1\\n else previous(Pregnancy_Complications_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Pregnancy_Complications_Past\",\"name\":\"Pregnancy_Complications_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Family Funeral\\\" then previous(Family_Funeral_Past)+1\\n else previous(Family_Funeral_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Family_Funeral_Past\",\"name\":\"Family_Funeral_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Medical Cover\\\" then previous(Medical_Cover_Past)+1\\n else previous(Medical_Cover_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Medical_Cover_Past\",\"name\":\"Medical_Cover_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Child Education Cover\\\" then previous(Child_Education_Cover_Past)+1\\n else previous(Child_Education_Cover_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Child_Education_Cover_Past\",\"name\":\"Child_Education_Cover_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Savings plan\\\" then previous(Savings_plan_Past)+1\\n else previous(Savings_plan_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Savings_plan_Past\",\"name\":\"Savings_plan_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Income Disability\\\" then previous(Income_Disability_Past)+1\\n else previous(Income_Disability_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Income_Disability_Past\",\"name\":\"Income_Disability_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Post Retirement\\\" then previous(Post_Retirement_Past)+1\\n else previous(Post_Retirement_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Post_Retirement_Past\",\"name\":\"Post_Retirement_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Medical Aid Premiums Cover\\\" then previous(Medical_Aid_Premiums_Cover_Past)+1\\n else previous(Medical_Aid_Premiums_Cover_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Medical_Aid_Premiums_Cover_Past\",\"name\":\"Medical_Aid_Premiums_Cover_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Policy Premiums Cover\\\" then previous(Policy_Premiums_Cover_Past)+1\\n else previous(Policy_Premiums_Cover_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Policy_Premiums_Cover_Past\",\"name\":\"Policy_Premiums_Cover_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Future Insurability\\\" then previous(Future_Insurability_Past)+1\\n else previous(Future_Insurability_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Future_Insurability_Past\",\"name\":\"Future_Insurability_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Others\\\" then previous(Others_Past)+1\\n else previous(Others_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Others_Past\",\"name\":\"Others_Past\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when previous('Needs_comb.Groupings_Formula') == \\\"Life Style\\\" then previous(Life_Style_Past)+1\\n else previous(Life_Style_Past) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"Life_Style_Past\",\"name\":\"Life_Style_Past\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"Purchase_Date_api\"}],\"partitionBy\":[\"owner_natl_id\"]},\"sources\":[\"ID_Dummy\"]},\"Removing duplicates\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when current('Needs_comb.Groupings_Formula') == previous('Needs_comb.Groupings_Formula') &&\\ncurrent(Purchase_Date_api) == previous(Purchase_Date_api) && current(Purchase_Group) == previous(Purchase_Group) then 1 else 0 end\",\"type\":\"Numeric\",\"scale\":15},\"label\":\"Duplicate_Need_flag\",\"name\":\"Duplicate_Need_flag\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"Needs_comb.Groupings_Formula\"}],\"partitionBy\":[\"owner_natl_id\"]},\"sources\":[\"Grouping_Owner_Purchase_Baskets\"]},\"Filter\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Duplicate_Need_flag == 0\"},\"sources\":[\"Removing duplicates\"]},\"Risk_Output_after_target_variable\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"AW_RiskOutputAfterTargetVariable\"}},\"ID_Dummy\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"1\",\"saqlExpression\":\"case when current(owner_natl_id) > previous(owner_natl_id) then previous(ID_Dummy)+1 else previous(ID_Dummy) end\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"ID_Dummy\",\"name\":\"ID_Dummy\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"owner_natl_id\"}],\"partitionBy\":[\"all\"]},\"sources\":[\"Row_ID\"]},\"Combined_View_3rd_Feb_2023\":{\"action\":\"register\",\"parameters\":{\"label\":\"Risk Output\",\"name\":\"AW_RiskOutput\"},\"sources\":[\"Previous_Product_Bought\"]},\"Previous_Product_Bought\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"\\\"None\\\"\",\"saqlExpression\":\"previous('Needs_comb.Groupings_Formula')\",\"type\":\"Text\"},\"label\":\"Previous_Product_Bought\",\"name\":\"Previous_Product_Bought\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"Row_ID_Creation\"}],\"partitionBy\":[\"owner_natl_id\"]},\"sources\":[\"Filter\"]},\"Grouping_Owner_Purchase_Baskets\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when current(Purchase_Date_api) == previous(Purchase_Date_api) then previous(Purchase_Group) else previous(Purchase_Group)+1 end\",\"type\":\"Numeric\",\"scale\":15},\"label\":\"Purchase_Group\",\"name\":\"Purchase_Group\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"Purchase_Date_api\"}],\"partitionBy\":[\"owner_natl_id\"]},\"sources\":[\"Need_fulfillment_history\"]}}}",null]